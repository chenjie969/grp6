<?xml version="1.0" encoding="UTF-8" standalone="no"?><jatools Class="jatools.ReportDocument" Name="jatools report template"><VariableContext/><Page><Children ItemClass="PagePanel"><Item0><Width>1237</Width><Height>141</Height><Children><Item0 Class="Label"><Text>河北融投担保集团项目分类处置汇总申报表</Text><Font><Face>宋体</Face><Style>1</Style><Size>36</Size></Font><HorizontalAlignment>1</HorizontalAlignment><X>226</X><Y>19</Y><Width>770</Width><Height>56</Height></Item0><Item1 Class="Label"><Text>金额单位：万元</Text><HorizontalAlignment>2</HorizontalAlignment><X>1111</X><Y>116</Y><Width>98</Width><Height>23</Height></Item1><Item2 Class="Label"><Text>截止年月：</Text><HorizontalAlignment>2</HorizontalAlignment><X>513</X><Y>94</Y><Width>77</Width><Height>23</Height></Item2><Item3 Class="Text"><Variable>=if(has(endyearmonthsql)) return endyearmonthsql;else return ($today+"").substring(0,7);</Variable><X>590</X><Y>94</Y><Width>110</Width><Height>23</Height></Item3></Children><Type>100</Type></Item0><Item1><Y>626</Y><Width>1237</Width><Height>22</Height><Type>103</Type></Item1><Item2><Y>141</Y><Width>1237</Width><Height>485</Height><Children ItemClass="Table"><Item0><NodePath>tab_division</NodePath><X>12</X><Y>2</Y><Children><Item0 Class="RowPanel"><Cell><Row>2</Row><Col>0</Col><ColSpan>13</ColSpan></Cell><Children ItemClass="Text"><Item0><Variable>=$.oldCountZb</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>0.00%</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>2</Row><Col>6</Col></Cell></Item0><Item1><Variable>=$.clientCount</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>0</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>2</Row><Col>1</Col></Cell></Item1><Item2><Variable>=$.countZb</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>0.00%</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>2</Row><Col>2</Col></Cell></Item2><Item3><Variable>=$.divisionName</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>2</Row><Col>0</Col></Cell></Item3><Item4><Variable>=$.guarantySum</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,##0.000000</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>2</Row><Col>3</Col></Cell></Item4><Item5><Variable>=$.entrustSum</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,##0.000000</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>2</Row><Col>4</Col></Cell></Item5><Item6><Variable>=$.oldClientCount</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>0</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>2</Row><Col>5</Col></Cell></Item6><Item7><Variable>=$.timePointSum</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,##0.000000</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>2</Row><Col>7</Col></Cell></Item7><Item8><Variable>=$.timePointEntrustSum</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,##0.000000</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>2</Row><Col>8</Col></Cell></Item8><Item9><Variable>=$.clientCount-$.oldClientCount</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>0</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>2</Row><Col>9</Col></Cell></Item9><Item10><Variable>=$.guarantySum-$.timePointSum</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,##0.000000</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>2</Row><Col>11</Col></Cell></Item10><Item11><Variable>=$.entrustSum-$.timePointEntrustSum</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,##0.000000</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>2</Row><Col>12</Col></Cell></Item11><Item12><Variable>=$.countZb-$.oldCountZb</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>0.00%</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>2</Row><Col>10</Col></Cell></Item12></Children><NodePath>Row</NodePath></Item0><Item1 Class="Label"><Text>分类</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>0</Row><Col>0</Col><RowSpan>2</RowSpan></Cell></Item1><Item2 Class="Label"><Text>数量</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>1</Row><Col>1</Col></Cell></Item2><Item3 Class="Label"><Text>占比</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>1</Row><Col>2</Col></Cell></Item3><Item4 Class="Label"><Text>数量</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>1</Row><Col>5</Col></Cell></Item4><Item5 Class="Label"><Text>占比</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>1</Row><Col>6</Col></Cell></Item5><Item6 Class="Text"><Variable>=if(has(endyearmonthsql)) return endyearmonthsql+"担保余额";else return ($today+"").substring(0,7)+"担保余额";</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>3</Col><RowSpan>2</RowSpan></Cell></Item6><Item7 Class="Text"><Variable>=if(has(endyearmonthsql)) return endyearmonthsql+"委贷余额";else return ($today+"").substring(0,7)+"委贷余额";</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>4</Col><RowSpan>2</RowSpan></Cell></Item7><Item8 Class="Label"><Text>2015年1月末户数（户）</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>0</Row><Col>5</Col><ColSpan>2</ColSpan></Cell></Item8><Item9 Class="Label"><Text>2015年1月末委贷余额</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>8</Col><RowSpan>2</RowSpan></Cell></Item9><Item10 Class="Label"><Text>户数增减变动情况</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>9</Col><ColSpan>2</ColSpan></Cell></Item10><Item11 Class="Label"><Text>担保余额变动情况</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>11</Col><RowSpan>2</RowSpan></Cell></Item11><Item12 Class="Label"><Text>委贷余额变动情况</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>12</Col><RowSpan>2</RowSpan></Cell></Item12><Item13 Class="Label"><Text>占比变动</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>1</Row><Col>10</Col></Cell></Item13><Item14 Class="Label"><Text>2015年1月末担保余额</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>7</Col><RowSpan>2</RowSpan></Cell></Item14><Item15 Class="Label"><Text>数量变动</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>1</Row><Col>9</Col></Cell></Item15><Item16 Class="Text"><Variable>=if(has(endyearmonthsql)) return endyearmonthsql+"户数（户）";else return ($today+"").substring(0,7)+"户数（户）";</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>1</Col><ColSpan>2</ColSpan></Cell></Item16><Item17 Class="Text"><Variable>=$.clientCount.sum()</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>3</Row><Col>1</Col></Cell></Item17><Item18 Class="Text"><Variable>=$.countZb.sum()</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>0%</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>3</Row><Col>2</Col></Cell></Item18><Item19 Class="Text"><Variable>=$.oldClientCount.sum()</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>3</Row><Col>5</Col></Cell></Item19><Item20 Class="Text"><Variable>=$.oldCountZb.sum()</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>0%</Pattern></Format><Cell><Row>3</Row><Col>6</Col></Cell></Item20><Item21 Class="Text"><Variable>=$.timePointSum.sum()</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,##0.000000</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>3</Row><Col>7</Col></Cell></Item21><Item22 Class="Text"><Variable>=$.clientCount.sum()-$.oldClientCount.sum()</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>3</Row><Col>9</Col></Cell></Item22><Item23 Class="Label"><Text>合计</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>3</Row><Col>0</Col></Cell></Item23><Item24 Class="Text"><Variable>=$.guarantySum.sum()</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,##0.000000</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>3</Row><Col>3</Col></Cell></Item24><Item25 Class="Text"><Variable>=$.entrustSum.sum()</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,##0.000000</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>3</Row><Col>4</Col></Cell></Item25><Item26 Class="Text"><Variable>=$.timePointEntrustSum.sum()</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,##0.000000</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>3</Row><Col>8</Col></Cell></Item26><Item27 Class="Text"><Variable>=$.guarantySum.sum()-$.timePointSum.sum()</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,##0.000000</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>3</Row><Col>11</Col></Cell></Item27><Item28 Class="Text"><Variable>=$.entrustSum.sum()-$.timePointEntrustSum.sum()</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,##0.000000</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>3</Row><Col>12</Col></Cell></Item28><Item29 Class="Text"><Variable>=$.countZb.sum()-$.oldCountZb.sum()</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>0%</Pattern></Format><Wordwrap>true</Wordwrap><Cell><Row>3</Row><Col>10</Col></Cell></Item29></Children><ColumnWidths>80,80,80,100,100,80,80,110,100,100,100,100,100</ColumnWidths><RowHeights>25,25,30,30</RowHeights></Item0></Children><Type>102</Type></Item2></Children><PageFormat><Width>1258</Width><Height>684</Height><Left>9</Left><Top>18</Top><Right>12</Right><Bottom>18</Bottom></PageFormat></Page><NodeSource><Children ItemClass="DatasetNodeSource"><Item0><Children ItemClass="RowNodeSource"><Item0/></Children><Reader Class="SqlReader"><Name>tab_division</Name><Sql>SELECT cc.`divisionID`,
cc.`divisionName`,
COUNT(DISTINCT cc.`clientGUID`) clientCount,
tt.clientCount oldClientCount,
tt.countZb oldCountZb,
tt.timePointSum,
tt.timePointEntrustSum,
(COUNT(DISTINCT cc.`clientGUID`)/( SELECT COUNT(c1.`clientGUID`) FROM crm_client c1 WHERE c1.`isMainVersion` = 1 AND c1.`divisionID` IS NOT NULL)) countZb,
SUM(IFNULL(tt1.guarantySum,0)) guarantySum,
SUM(IFNULL(tt2.entrustSum,0)) entrustSum
FROM crm_client cc 
LEFT JOIN crm_client_relationmain ccr ON ccr.`client_ID` = cc.client_ID
LEFT JOIN crm_relationmain cr ON cr.`relationMain_ID` = ccr.`relationMain_ID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM((IFNULL(pp.loadSum,0)-IFNULL(tab1.payCapitalSum,0)-IFNULL(tab2.replaceCapitalSum,0)-IFNULL(tab4.creditorsum,0))) AS guarantySum FROM pro_project pp
           LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
           LEFT JOIN (SELECT pfp.project_ID, SUM(IFNULL(pfp.payCapitalSum,0)) AS payCapitalSum FROM pro_factpay pfp 
                      WHERE 1=1 ${has(endyearmonthsql)?("  and  DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY pfp.project_ID
)tab1 ON tab1.project_ID =  pp.project_ID
LEFT JOIN ( SELECT pre.project_ID,SUM(IFNULL(pre.replaceCapitalSum,0)) AS replaceCapitalSum FROM pro_replace pre 
                      WHERE 1=1 ${has(endyearmonthsql)?("  and  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY pre.project_ID 
)tab2 ON tab2.project_ID =  pp.project_ID
LEFT JOIN (SELECT precre.project_ID,SUM(IFNULL(precre.creditor_sum,0)) AS creditorsum FROM pro_creditor precre
    WHERE 1=1 ${has(endyearmonthsql)?(" and  DATE_FORMAT(precre.creditor_date,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY precre.project_ID
)tab4 ON tab4.project_ID =  pp.project_ID 
WHERE  pp.`busiClass` = '01' ${has(endyearmonthsql)?(" and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""}
${has(wheresql)?(" and wheresql='"+wheresql+"'"):""} GROUP BY pa.`clientGUID`
) tt1 ON tt1.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM((IFNULL(pp.loadSum,0)-IFNULL(tab1.payCapitalSum,0)-IFNULL(tab2.replaceCapitalSum,0)-IFNULL(tab4.creditorsum,0))) AS entrustSum FROM pro_project pp
           LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
           LEFT JOIN (SELECT pfp.project_ID, SUM(IFNULL(pfp.payCapitalSum,0)) AS payCapitalSum FROM pro_factpay pfp 
                      WHERE 1=1 ${has(endyearmonthsql)?("  and  DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY pfp.project_ID
)tab1 ON tab1.project_ID =  pp.project_ID
LEFT JOIN ( SELECT pre.project_ID,SUM(IFNULL(pre.replaceCapitalSum,0)) AS replaceCapitalSum FROM pro_replace pre 
                      WHERE 1=1 ${has(endyearmonthsql)?("  and  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY pre.project_ID 
)tab2 ON tab2.project_ID =  pp.project_ID
LEFT JOIN (SELECT precre.project_ID,SUM(IFNULL(precre.creditor_sum,0)) AS creditorsum FROM pro_creditor precre
    WHERE 1=1 ${has(endyearmonthsql)?(" and  DATE_FORMAT(precre.creditor_date,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY precre.project_ID
)tab4 ON tab4.project_ID =  pp.project_ID 
WHERE  pp.`busiClass` = '02' ${has(endyearmonthsql)?(" and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""}
${has(wheresql)?(" and wheresql='"+wheresql+"'"):""} GROUP BY pa.`clientGUID`
) tt2 ON tt2.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT cc.`oldDivisionName`,COUNT(DISTINCT cc.`clientGUID`) clientCount,
(COUNT(DISTINCT cc.`clientGUID`)/( SELECT COUNT(c1.`clientGUID`) FROM crm_client c1 WHERE c1.`isMainVersion` = 1 AND c1.`oldDivisionID` IS NOT NULL)) countZb,
SUM(IFNULL(cc.`timePointSum`,0)) timePointSum,SUM(IFNULL(cc.`timePointEntrustSum`,0)) timePointEntrustSum
FROM crm_client cc WHERE cc.`isMainVersion` = 1 AND cc.`oldDivisionID` IS NOT NULL GROUP BY cc.`oldDivisionID`
) tt ON tt.oldDivisionName = cc.`divisionName`
WHERE cc.`isMainVersion` = 1 AND cc.`divisionID` IS NOT NULL GROUP BY cc.`divisionID`</Sql><Description>SELECT cc.`divisionID`,
cc.`divisionName`,
COUNT(DISTINCT cc.`clientGUID`) clientCount,
tt.clientCount oldClientCount,
tt.countZb oldCountZb,
tt.timePointSum,
tt.timePointEntrustSum,
(COUNT(DISTINCT cc.`clientGUID`)/( SELECT COUNT(c1.`clientGUID`) FROM crm_client c1 WHERE c1.`isMainVersion` = 1 AND c1.`divisionID` IS NOT NULL)) countZb,
SUM(IFNULL(tt1.guarantySum,0)) guarantySum,
SUM(IFNULL(tt2.entrustSum,0)) entrustSum
FROM crm_client cc 
LEFT JOIN crm_client_relationmain ccr ON ccr.`client_ID` = cc.client_ID
LEFT JOIN crm_relationmain cr ON cr.`relationMain_ID` = ccr.`relationMain_ID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM((IFNULL(pp.loadSum,0)-IFNULL(tab1.payCapitalSum,0)-IFNULL(tab2.replaceCapitalSum,0)-IFNULL(tab4.creditorsum,0))) AS guarantySum FROM pro_project pp
           LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
           LEFT JOIN (SELECT pfp.project_ID, SUM(IFNULL(pfp.payCapitalSum,0)) AS payCapitalSum FROM pro_factpay pfp 
                      WHERE 1=1 ${has(endyearmonthsql)?("  and  DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY pfp.project_ID
)tab1 ON tab1.project_ID =  pp.project_ID
LEFT JOIN ( SELECT pre.project_ID,SUM(IFNULL(pre.replaceCapitalSum,0)) AS replaceCapitalSum FROM pro_replace pre 
                      WHERE 1=1 ${has(endyearmonthsql)?("  and  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY pre.project_ID 
)tab2 ON tab2.project_ID =  pp.project_ID
LEFT JOIN (SELECT precre.project_ID,SUM(IFNULL(precre.creditor_sum,0)) AS creditorsum FROM pro_creditor precre
    WHERE 1=1 ${has(endyearmonthsql)?(" and  DATE_FORMAT(precre.creditor_date,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY precre.project_ID
)tab4 ON tab4.project_ID =  pp.project_ID 
WHERE  pp.`busiClass` = '01' ${has(endyearmonthsql)?(" and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""}
${has(wheresql)?(" and wheresql='"+wheresql+"'"):""} GROUP BY pa.`clientGUID`
) tt1 ON tt1.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM((IFNULL(pp.loadSum,0)-IFNULL(tab1.payCapitalSum,0)-IFNULL(tab2.replaceCapitalSum,0)-IFNULL(tab4.creditorsum,0))) AS entrustSum FROM pro_project pp
           LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
           LEFT JOIN (SELECT pfp.project_ID, SUM(IFNULL(pfp.payCapitalSum,0)) AS payCapitalSum FROM pro_factpay pfp 
                      WHERE 1=1 ${has(endyearmonthsql)?("  and  DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY pfp.project_ID
)tab1 ON tab1.project_ID =  pp.project_ID
LEFT JOIN ( SELECT pre.project_ID,SUM(IFNULL(pre.replaceCapitalSum,0)) AS replaceCapitalSum FROM pro_replace pre 
                      WHERE 1=1 ${has(endyearmonthsql)?("  and  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY pre.project_ID 
)tab2 ON tab2.project_ID =  pp.project_ID
LEFT JOIN (SELECT precre.project_ID,SUM(IFNULL(precre.creditor_sum,0)) AS creditorsum FROM pro_creditor precre
    WHERE 1=1 ${has(endyearmonthsql)?(" and  DATE_FORMAT(precre.creditor_date,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY precre.project_ID
)tab4 ON tab4.project_ID =  pp.project_ID 
WHERE  pp.`busiClass` = '02' ${has(endyearmonthsql)?(" and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""}
${has(wheresql)?(" and wheresql='"+wheresql+"'"):""} GROUP BY pa.`clientGUID`
) tt2 ON tt2.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT cc.`oldDivisionName`,COUNT(DISTINCT cc.`clientGUID`) clientCount,
(COUNT(DISTINCT cc.`clientGUID`)/( SELECT COUNT(c1.`clientGUID`) FROM crm_client c1 WHERE c1.`isMainVersion` = 1 AND c1.`oldDivisionID` IS NOT NULL)) countZb,
SUM(IFNULL(cc.`timePointSum`,0)) timePointSum,SUM(IFNULL(cc.`timePointEntrustSum`,0)) timePointEntrustSum
FROM crm_client cc WHERE cc.`isMainVersion` = 1 AND cc.`oldDivisionID` IS NOT NULL GROUP BY cc.`oldDivisionID`
) tt ON tt.oldDivisionName = cc.`divisionName`
WHERE cc.`isMainVersion` = 1 AND cc.`divisionID` IS NOT NULL GROUP BY cc.`divisionID`</Description><Connection><Driver>${property("proxool.driverClassName")}</Driver><User>${property("proxool.username")}</User><Password>${property("proxool.password")}</Password><Url>${property("proxool.url")}</Url></Connection></Reader><TagName>tab_division</TagName></Item0><Item1><Children><Item0 Class="IndexNodeSource"><IndexFields Len="1">dicTypeID</IndexFields><TagName>index_divisionID</TagName></Item0><Item1 Class="RowNodeSource"/></Children><Reader Class="SqlReader"><Name>dic_division</Name><Sql>SELECT dicTypeID,dicTypeName FROM c_dictype WHERE dicTypePID = 'cb2b7adef9c740daa4c43fda3d4d4d11' ORDER BY order_id ASC</Sql><Description>SELECT dicTypeID,dicTypeName FROM c_dictype WHERE dicTypePID = 'cb2b7adef9c740daa4c43fda3d4d4d11' ORDER BY order_id ASC</Description><Connection><Driver>${property("proxool.driverClassName")}</Driver><User>${property("proxool.username")}</User><Password>${property("proxool.password")}</Password><Url>${property("proxool.url")}</Url></Connection></Reader><IndexFields Len="1">dicTypeID</IndexFields><TagName>dic_division</TagName></Item1></Children></NodeSource><Properties/></jatools>