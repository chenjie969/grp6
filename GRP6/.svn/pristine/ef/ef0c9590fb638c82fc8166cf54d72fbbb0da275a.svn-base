<?xml version="1.0" encoding="UTF-8" standalone="no"?><jatools Class="jatools.ReportDocument" Name="jatools report template"><VariableContext/><Page><Children ItemClass="PagePanel"><Item0><Width>1399</Width><Height>141</Height><Children><Item0 Class="Label"><Text>河北融投风险化解35户重点项目压降明细表</Text><Font><Face>宋体</Face><Style>1</Style><Size>36</Size></Font><HorizontalAlignment>1</HorizontalAlignment><X>307</X><Y>19</Y><Width>770</Width><Height>56</Height></Item0><Item1 Class="Label"><Text>金额单位：亿元</Text><HorizontalAlignment>2</HorizontalAlignment><X>1280</X><Y>113</Y><Width>98</Width><Height>23</Height></Item1><Item2 Class="Label"><Text>截止年月：</Text><HorizontalAlignment>2</HorizontalAlignment><X>606</X><Y>94</Y><Width>77</Width><Height>23</Height></Item2><Item3 Class="Text"><Variable>=if(has(endyearmonthsql)) return endyearmonthsql;else return ($today+"").substring(0,7);</Variable><X>683</X><Y>94</Y><Width>110</Width><Height>23</Height></Item3></Children><Type>100</Type></Item0><Item1><Y>863</Y><Width>1399</Width><Height>22</Height><Type>103</Type></Item1><Item2><Y>141</Y><Width>1399</Width><Height>722</Height><Children ItemClass="Table"><Item0><X>27</X><Y>5</Y><Children><Item0 Class="RowPanel"><Cell><Row>1</Row><Col>0</Col><RowSpan>2</RowSpan><ColSpan>13</ColSpan></Cell><Children ItemClass="RowPanel"><Item0><Cell><Row>1</Row><Col>0</Col><RowSpan>2</RowSpan><ColSpan>13</ColSpan></Cell><Children><Item0 Class="RowPanel"><Cell><Row>1</Row><Col>0</Col><ColSpan>13</ColSpan></Cell><Children ItemClass="Text"><Item0><Variable>=$.clientName</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>1</Row><Col>3</Col></Cell></Item0><Item1><Variable>=$.relationMainName</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><PrintStyle>united-level:2;auto-size:height;</PrintStyle><Cell><Row>1</Row><Col>2</Col></Cell></Item1><Item2><Variable>=$.fullAreaName</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><PrintStyle>united-level:1;auto-size:height;</PrintStyle><Cell><Row>1</Row><Col>1</Col></Cell></Item2><Item3><Variable>=$.position + 1</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><Wordwrap>true</Wordwrap><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>1</Row><Col>0</Col></Cell></Item3><Item4><Variable>=$.guarantySum/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>1</Row><Col>7</Col></Cell></Item4><Item5><Variable>=$.entrustSum/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>1</Row><Col>8</Col></Cell></Item5><Item6><Variable>=$.entrustSum/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>1</Row><Col>9</Col></Cell></Item6><Item7><Variable>=($.timePointSum-$.guarantySum)/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>1</Row><Col>10</Col></Cell></Item7><Item8><Variable>=$.payCapitalSum/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>1</Row><Col>11</Col></Cell></Item8><Item9><Variable>=$.payInterestSum/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>1</Row><Col>12</Col></Cell></Item9><Item10><Variable>=$.timePointEntrustSum/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>1</Row><Col>6</Col></Cell></Item10><Item11><Variable>=$.timePointSum/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>1</Row><Col>4</Col></Cell></Item11><Item12><Variable>=$.wdAllGuarantySum/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>1</Row><Col>5</Col></Cell></Item12></Children><NodePath>Row</NodePath></Item0><Item1 Class="Text"><Variable>=$.timePointSum.sum()/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><Cell><Row>2</Row><Col>4</Col></Cell></Item1><Item2 Class="Text"><Variable>=$.guarantySum.sum()/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>2</Row><Col>7</Col></Cell></Item2><Item3 Class="Text"><Variable>=$.entrustSum.sum()/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>2</Row><Col>8</Col></Cell></Item3><Item4 Class="Text"><Variable>=($.timePointSum.sum()-$.guarantySum.sum())/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>2</Row><Col>10</Col></Cell></Item4><Item5 Class="Text"><Variable>=$.payCapitalSum.sum()/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>2</Row><Col>11</Col></Cell></Item5><Item6 Class="Text"><Variable>=$.payInterestSum.sum()/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>2</Row><Col>12</Col></Cell></Item6><Item7 Class="Text"><Variable>=$.entrustSum.sum()/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>2</Row><Col>9</Col></Cell></Item7><Item8 Class="Label"><Text>小计</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>2</Row><Col>0</Col><ColSpan>4</ColSpan></Cell></Item8><Item9 Class="Text"><Variable>=$.timePointEntrustSum.sum()/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>2</Row><Col>5</Col></Cell></Item9><Item10 Class="Text"><Variable>=$.timePointEntrustSum.sum()/10000</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><Font><Face>宋体</Face><Style>1</Style><Size>12</Size></Font><HorizontalAlignment>1</HorizontalAlignment><Format Class="DecimalFormat"><Pattern>#,###.######</Pattern></Format><PrintStyle>auto-size:height;</PrintStyle><Cell><Row>2</Row><Col>6</Col></Cell></Item10></Children><NodePath>fullAreaName</NodePath></Item0></Children><NodePath>tab_detail</NodePath></Item0><Item1 Class="Text"><Variable>=if(has(endyearmonthsql)) return endyearmonthsql+"末融投系委贷余额";else return ($today+"").substring(0,7)+"末融投系委贷余额";</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>9</Col></Cell></Item1><Item2 Class="Text"><Variable>=if(has(endyearmonthsql)) return endyearmonthsql+"末担保集团委贷余额";else return ($today+"").substring(0,7)+"末担保集团委贷余额";</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>8</Col></Cell></Item2><Item3 Class="Text"><Variable>=if(has(endyearmonthsql)) return endyearmonthsql+"末担保余额";else return ($today+"").substring(0,7)+"末担保余额";</Variable><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>7</Col></Cell></Item3><Item4 Class="Label"><Text>担保压降金额</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>0</Row><Col>10</Col></Cell></Item4><Item5 Class="Label"><Text>融投系清收清欠金额</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>12</Col></Cell></Item5><Item6 Class="Label"><Text>融投系委贷本金清收</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>11</Col></Cell></Item6><Item7 Class="Label"><Text>所属区域</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>0</Row><Col>1</Col></Cell></Item7><Item8 Class="Label"><Text>序号</Text><Border/><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>0</Row><Col>0</Col></Cell></Item8><Item9 Class="Label"><Text>2015年1月末融投系委贷余额</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>6</Col></Cell></Item9><Item10 Class="Label"><Text>2015年1月末
担保集团委贷余额</Text><Border/><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>5</Col></Cell></Item10><Item11 Class="Label"><Text>2015年1月
末担保余额</Text><Border/><HorizontalAlignment>1</HorizontalAlignment><Wordwrap>true</Wordwrap><Cell><Row>0</Row><Col>4</Col></Cell></Item11><Item12 Class="Label"><Text>关联系</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>0</Row><Col>2</Col></Cell></Item12><Item13 Class="Label"><Text>项目名称</Text><Border><StyleText>border:1.0px solid #000000</StyleText></Border><HorizontalAlignment>1</HorizontalAlignment><Cell><Row>0</Row><Col>3</Col></Cell></Item13></Children><ColumnWidths>60,100,100,200,100,110,100,100,100,100,100,100,100</ColumnWidths><RowHeights>35,30,30</RowHeights></Item0></Children><Type>102</Type></Item2></Children><PageFormat><Width>1411</Width><Height>921</Height><Left>0</Left><Top>18</Top><Right>12</Right><Bottom>18</Bottom></PageFormat></Page><NodeSource><Children ItemClass="DatasetNodeSource"><Item0><Children ItemClass="GroupNodeSource"><Item0><Children ItemClass="RowNodeSource"><Item0/></Children><Group><Field>fullAreaName</Field></Group></Item0></Children><Reader Class="SqlReader"><Name>tab_detail</Name><Sql>SELECT A.fullAreaName,A.relationMainName,A.clientName,
SUM(A.timePointSum) timePointSum,
SUM(A.timePointEntrustSum) timePointEntrustSum,
SUM(A.wdAllGuarantySum) wdAllGuarantySum,
SUM(A.guarantySum)guarantySum,SUM(A.entrustSum)entrustSum,A.payCapitalSum,A.payInterestSum from (

SELECT cc.fullAreaName,cc.`relationMainName`,cc.`clientName`,
	0 timePointSum,
	0 timePointEntrustSum,
	0 wdAllGuarantySum,IFNULL(tt1.guarantySum,0) guarantySum,IFNULL(tt2.entrustSum,0) entrustSum,IFNULL(pay.payCapitalSum,0) payCapitalSum,IFNULL(pay.payInterestSum,0) payInterestSum
FROM crm_client cc 
LEFT JOIN crm_client_relationmain ccr ON ccr.`client_ID` = cc.client_ID
LEFT JOIN crm_relationmain cr ON cr.`relationMain_ID` = ccr.`relationMain_ID`
LEFT JOIN (
	SELECT
		pa.`clientGUID`,
		SUM((IFNULL(pp.loadSum, 0) - IFNULL(tab1.payCapitalSum, 0) - IFNULL(tab2.replaceCapitalSum, 0))) AS guarantySum
	FROM
		pro_project pp
	LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
	LEFT JOIN (
		SELECT
			pfp.project_ID,
			SUM(IFNULL(pfp.payCapitalSum, 0)) AS payCapitalSum
		FROM
			pro_factpay pfp
		WHERE 1 = 1 AND DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='2015-01' GROUP BY
			pfp.project_ID
	) tab1 ON tab1.project_ID = pp.project_ID
	LEFT JOIN (
		SELECT
			pre.project_ID,
			SUM(IFNULL(pre.replaceCapitalSum, 0)) AS replaceCapitalSum
		FROM
			pro_replace pre
		WHERE
			1 = 1 AND  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='2015-01' GROUP BY pre.project_ID
	) tab2 ON tab2.project_ID = pp.project_ID
	WHERE
		pp.`busiClass` = '01' 
		AND DATE_FORMAT(pp.reportDate,'%Y-%m')&lt;= '2015-01'
		GROUP BY pa.`clientGUID`
) db15 ON db15.clientGUID = cc.`clientGUID`

LEFT JOIN (
	SELECT
		pa.`clientGUID`,
		SUM((IFNULL(pp.loadSum, 0) - IFNULL(tab1.payCapitalSum, 0) - IFNULL(tab2.replaceCapitalSum, 0))) AS guarantySum
	FROM
		pro_project pp
	LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
	LEFT JOIN (
		SELECT
			pfp.project_ID,
			SUM(IFNULL(pfp.payCapitalSum, 0)) AS payCapitalSum
		FROM
			pro_factpay pfp
		WHERE 1 = 1 AND DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='2015-01' GROUP BY
			pfp.project_ID
	) tab1 ON tab1.project_ID = pp.project_ID
	LEFT JOIN (
		SELECT
			pre.project_ID,
			SUM(IFNULL(pre.replaceCapitalSum, 0)) AS replaceCapitalSum
		FROM
			pro_replace pre
		WHERE
			1 = 1 AND  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='2015-01' GROUP BY pre.project_ID
	) tab2 ON tab2.project_ID = pp.project_ID
	WHERE
		pp.`busiClass` = '02' 
		AND DATE_FORMAT(pp.reportDate,'%Y-%m') &lt;= '2015-01'
		AND pa.guarantyOrgID in ('1b6f710ce5054d1d8f9d495f7bc1e142','fbe555a29dd94ed08dacf374dcd85ead','d6f953c683ea41abb946a42fc1004642','73c1bb3d20614bdfa91281622c5b9334')
		GROUP BY pa.`clientGUID`
) wd15 ON wd15.clientGUID = cc.`clientGUID`

LEFT JOIN (
	SELECT
		pa.`clientGUID`,
		SUM((IFNULL(pp.loadSum, 0) - IFNULL(tab1.payCapitalSum, 0) - IFNULL(tab2.replaceCapitalSum, 0))) AS guarantySum
	FROM
		pro_project pp
	LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
	LEFT JOIN (
		SELECT
			pfp.project_ID,
			SUM(IFNULL(pfp.payCapitalSum, 0)) AS payCapitalSum
		FROM
			pro_factpay pfp
		WHERE 1 = 1 AND DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='2015-01' GROUP BY
			pfp.project_ID
	) tab1 ON tab1.project_ID = pp.project_ID
	LEFT JOIN (
		SELECT
			pre.project_ID,
			SUM(IFNULL(pre.replaceCapitalSum, 0)) AS replaceCapitalSum
		FROM
			pro_replace pre
		WHERE
			1 = 1 AND  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='2015-01' GROUP BY pre.project_ID
	) tab2 ON tab2.project_ID = pp.project_ID
	WHERE
		pp.`busiClass` = '02' 
		AND DATE_FORMAT(pp.reportDate,'%Y-%m') &lt;= '2015-01'
		GROUP BY pa.`clientGUID`
) wdAll15 ON wdAll15.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM((IFNULL(pp.loadSum,0)-IFNULL(tab1.payCapitalSum,0)-IFNULL(tab2.replaceCapitalSum,0))) AS guarantySum FROM pro_project pp
           LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
           LEFT JOIN (SELECT pfp.project_ID, SUM(IFNULL(pfp.payCapitalSum,0)) AS payCapitalSum FROM pro_factpay pfp 
                      WHERE 1=1 ${has(endyearmonthsql)?("  and  DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY pfp.project_ID
)tab1 ON tab1.project_ID =  pp.project_ID
LEFT JOIN ( SELECT pre.project_ID,SUM(IFNULL(pre.replaceCapitalSum,0)) AS replaceCapitalSum FROM pro_replace pre 
                      WHERE 1=1 ${has(endyearmonthsql)?("  and  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY pre.project_ID 
)tab2 ON tab2.project_ID =  pp.project_ID
WHERE  pp.`busiClass` = '01' 
${has(endyearmonthsql)?(" and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""}
${has(wheresql)?(" and wheresql='"+wheresql+"'"):""}   GROUP BY pa.`clientGUID`
) tt1 ON tt1.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM((IFNULL(pp.loadSum,0)-IFNULL(tab1.payCapitalSum,0))) AS entrustSum FROM pro_project pp
           LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
           LEFT JOIN (SELECT pfp.project_ID, SUM(IFNULL(pfp.payCapitalSum,0)) AS payCapitalSum FROM pro_factpay pfp 
                      WHERE 1=1 ${has(endyearmonthsql)?("  and  DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY pfp.project_ID
)tab1 ON tab1.project_ID =  pp.project_ID
WHERE  pp.`busiClass` = '02' 
${has(endyearmonthsql)?(" and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""}
${has(wheresql)?(" and wheresql='"+wheresql+"'"):""}  GROUP BY pa.`clientGUID`
) tt2 ON tt2.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM(pfp.`payCapitalSum`) payCapitalSum,SUM(pfp.`payInterestSum`) payInterestSum FROM pro_factpay pfp
           LEFT JOIN pro_project pp ON pp.`project_ID` = pfp.`project_ID`
           LEFT JOIN pro_apply pa ON pfp.`applyID` = pa.`apply_ID`
           WHERE pp.`busiClass` = '02' ${has(endyearmonthsql)?("  and  DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} 
           ${has(endyearmonthsql)?(" and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""}
           ${has(wheresql)?(" and wheresql='"+wheresql+"'"):""}GROUP BY pa.`clientGUID`
) pay ON pay.clientGUID = cc.`clientGUID`
WHERE cr.projectTypeID = '44950f5de8614f1588841a9556ba52a2'
UNION ALL
SELECT cc.fullAreaName,
	cc.`relationMainName`,
	cc.`clientName`,IFNULL(tt1.guarantySum,0) timePointSum,
	IFNULL(tt2.entrustSum,0) timePointEntrustSum,
	IFNULL(db15.guarantySum, 0) timePointSum,
	IFNULL(wd15.`guarantySum`,0) timePointEntrustSum,
	IFNULL(wdAll15.`guarantySum`,0) wdAllGuarantySum,
	IFNULL(pay.payCapitalSum,0) payCapitalSum,
	IFNULL(pay.payInterestSum,0) payInterestSum
FROM crm_client cc 
LEFT JOIN crm_client_relationmain ccr ON ccr.`client_ID` = cc.client_ID
LEFT JOIN crm_relationmain cr ON cr.`relationMain_ID` = ccr.`relationMain_ID`
LEFT JOIN (
	SELECT
		pa.`clientGUID`,
		SUM((IFNULL(pp.loadSum, 0) - IFNULL(tab1.payCapitalSum, 0) - IFNULL(tab2.replaceCapitalSum, 0))) AS guarantySum
	FROM
		pro_project pp
	LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
	LEFT JOIN (
		SELECT
			pfp.project_ID,
			SUM(IFNULL(pfp.payCapitalSum, 0)) AS payCapitalSum
		FROM
			pro_factpay pfp
		WHERE 1 = 1 AND DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='2015-01' GROUP BY
			pfp.project_ID
	) tab1 ON tab1.project_ID = pp.project_ID
	LEFT JOIN (
		SELECT
			pre.project_ID,
			SUM(IFNULL(pre.replaceCapitalSum, 0)) AS replaceCapitalSum
		FROM
			pro_replace pre
		WHERE
			1 = 1 AND  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='2015-01' GROUP BY pre.project_ID
	) tab2 ON tab2.project_ID = pp.project_ID
	WHERE
		pp.`busiClass` = '01' 
		AND DATE_FORMAT(pp.reportDate,'%Y-%m')&lt;= '2015-01'
		GROUP BY pa.`clientGUID`
) db15 ON db15.clientGUID = cc.`clientGUID`

LEFT JOIN (
	SELECT
		pa.`clientGUID`,
		SUM((IFNULL(pp.loadSum, 0) - IFNULL(tab1.payCapitalSum, 0) - IFNULL(tab2.replaceCapitalSum, 0))) AS guarantySum
	FROM
		pro_project pp
	LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
	LEFT JOIN (
		SELECT
			pfp.project_ID,
			SUM(IFNULL(pfp.payCapitalSum, 0)) AS payCapitalSum
		FROM
			pro_factpay pfp
		WHERE 1 = 1 AND DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='2015-01' GROUP BY
			pfp.project_ID
	) tab1 ON tab1.project_ID = pp.project_ID
	LEFT JOIN (
		SELECT
			pre.project_ID,
			SUM(IFNULL(pre.replaceCapitalSum, 0)) AS replaceCapitalSum
		FROM
			pro_replace pre
		WHERE
			1 = 1 AND  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='2015-01' GROUP BY pre.project_ID
	) tab2 ON tab2.project_ID = pp.project_ID
	WHERE
		pp.`busiClass` = '02' 
		AND DATE_FORMAT(pp.reportDate,'%Y-%m') &lt;= '2015-01'
		AND pa.guarantyOrgID in ('1b6f710ce5054d1d8f9d495f7bc1e142','fbe555a29dd94ed08dacf374dcd85ead','d6f953c683ea41abb946a42fc1004642','73c1bb3d20614bdfa91281622c5b9334')
		GROUP BY pa.`clientGUID`
) wd15 ON wd15.clientGUID = cc.`clientGUID`

LEFT JOIN (
	SELECT
		pa.`clientGUID`,
		SUM((IFNULL(pp.loadSum, 0) - IFNULL(tab1.payCapitalSum, 0) - IFNULL(tab2.replaceCapitalSum, 0))) AS guarantySum
	FROM
		pro_project pp
	LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
	LEFT JOIN (
		SELECT
			pfp.project_ID,
			SUM(IFNULL(pfp.payCapitalSum, 0)) AS payCapitalSum
		FROM
			pro_factpay pfp
		WHERE 1 = 1 AND DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='2015-01' GROUP BY
			pfp.project_ID
	) tab1 ON tab1.project_ID = pp.project_ID
	LEFT JOIN (
		SELECT
			pre.project_ID,
			SUM(IFNULL(pre.replaceCapitalSum, 0)) AS replaceCapitalSum
		FROM
			pro_replace pre
		WHERE
			1 = 1 AND  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='2015-01' GROUP BY pre.project_ID
	) tab2 ON tab2.project_ID = pp.project_ID
	WHERE
		pp.`busiClass` = '02' 
		AND DATE_FORMAT(pp.reportDate,'%Y-%m') &lt;= '2015-01'
		GROUP BY pa.`clientGUID`
) wdAll15 ON wdAll15.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM((IFNULL(pp.loadSum,0)-IFNULL(tab1.payCapitalSum,0)-IFNULL(tab2.replaceCapitalSum,0))) AS guarantySum FROM pro_project pp
           LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
           LEFT JOIN (SELECT pfp.project_ID, SUM(IFNULL(pfp.payCapitalSum,0)) AS payCapitalSum FROM pro_factpay pfp 
                      WHERE 1=1   and  DATE_FORMAT(pfp.payDate,'%Y-%m') BETWEEN '2015-01-01' AND '2015-01-31' GROUP BY pfp.project_ID
)tab1 ON tab1.project_ID =  pp.project_ID
LEFT JOIN ( SELECT pre.project_ID,SUM(IFNULL(pre.replaceCapitalSum,0)) AS replaceCapitalSum FROM pro_replace pre 
                      WHERE 1=1   and  DATE_FORMAT(pre.replaceDate,'%Y-%m-%d') BETWEEN '2015-01-01' AND '2015-01-31' GROUP BY pre.project_ID 
)tab2 ON tab2.project_ID =  pp.project_ID
WHERE  pp.`busiClass` = '01' 
 and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m-%d') BETWEEN '2015-01-01' AND '2015-01-31'
   GROUP BY pa.`clientGUID`
) tt1 ON tt1.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM((IFNULL(pp.loadSum,0)-IFNULL(tab1.payCapitalSum,0))) AS entrustSum FROM pro_project pp
           LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
           LEFT JOIN (SELECT pfp.project_ID, SUM(IFNULL(pfp.payCapitalSum,0)) AS payCapitalSum FROM pro_factpay pfp 
                      WHERE 1=1   and  DATE_FORMAT(pfp.payDate,'%Y-%m-%d') BETWEEN '2015-01-01' AND '2015-01-31' GROUP BY pfp.project_ID
)tab1 ON tab1.project_ID =  pp.project_ID
WHERE  pp.`busiClass` = '02' 
 and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m-%d') BETWEEN '2015-01-01' AND '2015-01-31'
  GROUP BY pa.`clientGUID`
) tt2 ON tt2.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM(pfp.`payCapitalSum`) payCapitalSum,SUM(pfp.`payInterestSum`) payInterestSum FROM pro_factpay pfp
           LEFT JOIN pro_project pp ON pp.`project_ID` = pfp.`project_ID`
           LEFT JOIN pro_apply pa ON pfp.`applyID` = pa.`apply_ID`
           WHERE pp.`busiClass` = '02'   and  DATE_FORMAT(pfp.payDate,'%Y-%m-%d') BETWEEN '2015-01-01' AND '2015-01-31'
            and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m-%d') BETWEEN '2015-01-01' AND '2015-01-31'
           GROUP BY pa.`clientGUID`
) pay ON pay.clientGUID = cc.`clientGUID`
WHERE cr.projectTypeID = '44950f5de8614f1588841a9556ba52a2' 
) A
GROUP BY A.`clientName`</Sql><Description>SELECT A.fullAreaName,A.relationMainName,A.clientName,
SUM(A.timePointSum) timePointSum,
SUM(A.timePointEntrustSum) timePointEntrustSum,
SUM(A.wdAllGuarantySum) wdAllGuarantySum,
SUM(A.guarantySum)guarantySum,SUM(A.entrustSum)entrustSum,A.payCapitalSum,A.payInterestSum from (

SELECT cc.fullAreaName,cc.`relationMainName`,cc.`clientName`,
	0 timePointSum,
	0 timePointEntrustSum,
	0 wdAllGuarantySum,IFNULL(tt1.guarantySum,0) guarantySum,IFNULL(tt2.entrustSum,0) entrustSum,IFNULL(pay.payCapitalSum,0) payCapitalSum,IFNULL(pay.payInterestSum,0) payInterestSum
FROM crm_client cc 
LEFT JOIN crm_client_relationmain ccr ON ccr.`client_ID` = cc.client_ID
LEFT JOIN crm_relationmain cr ON cr.`relationMain_ID` = ccr.`relationMain_ID`
LEFT JOIN (
	SELECT
		pa.`clientGUID`,
		SUM((IFNULL(pp.loadSum, 0) - IFNULL(tab1.payCapitalSum, 0) - IFNULL(tab2.replaceCapitalSum, 0))) AS guarantySum
	FROM
		pro_project pp
	LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
	LEFT JOIN (
		SELECT
			pfp.project_ID,
			SUM(IFNULL(pfp.payCapitalSum, 0)) AS payCapitalSum
		FROM
			pro_factpay pfp
		WHERE 1 = 1 AND DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='2015-01' GROUP BY
			pfp.project_ID
	) tab1 ON tab1.project_ID = pp.project_ID
	LEFT JOIN (
		SELECT
			pre.project_ID,
			SUM(IFNULL(pre.replaceCapitalSum, 0)) AS replaceCapitalSum
		FROM
			pro_replace pre
		WHERE
			1 = 1 AND  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='2015-01' GROUP BY pre.project_ID
	) tab2 ON tab2.project_ID = pp.project_ID
	WHERE
		pp.`busiClass` = '01' 
		AND DATE_FORMAT(pp.reportDate,'%Y-%m')&lt;= '2015-01'
		GROUP BY pa.`clientGUID`
) db15 ON db15.clientGUID = cc.`clientGUID`

LEFT JOIN (
	SELECT
		pa.`clientGUID`,
		SUM((IFNULL(pp.loadSum, 0) - IFNULL(tab1.payCapitalSum, 0) - IFNULL(tab2.replaceCapitalSum, 0))) AS guarantySum
	FROM
		pro_project pp
	LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
	LEFT JOIN (
		SELECT
			pfp.project_ID,
			SUM(IFNULL(pfp.payCapitalSum, 0)) AS payCapitalSum
		FROM
			pro_factpay pfp
		WHERE 1 = 1 AND DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='2015-01' GROUP BY
			pfp.project_ID
	) tab1 ON tab1.project_ID = pp.project_ID
	LEFT JOIN (
		SELECT
			pre.project_ID,
			SUM(IFNULL(pre.replaceCapitalSum, 0)) AS replaceCapitalSum
		FROM
			pro_replace pre
		WHERE
			1 = 1 AND  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='2015-01' GROUP BY pre.project_ID
	) tab2 ON tab2.project_ID = pp.project_ID
	WHERE
		pp.`busiClass` = '02' 
		AND DATE_FORMAT(pp.reportDate,'%Y-%m') &lt;= '2015-01'
		AND pa.guarantyOrgID in ('1b6f710ce5054d1d8f9d495f7bc1e142','fbe555a29dd94ed08dacf374dcd85ead','d6f953c683ea41abb946a42fc1004642','73c1bb3d20614bdfa91281622c5b9334')
		GROUP BY pa.`clientGUID`
) wd15 ON wd15.clientGUID = cc.`clientGUID`

LEFT JOIN (
	SELECT
		pa.`clientGUID`,
		SUM((IFNULL(pp.loadSum, 0) - IFNULL(tab1.payCapitalSum, 0) - IFNULL(tab2.replaceCapitalSum, 0))) AS guarantySum
	FROM
		pro_project pp
	LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
	LEFT JOIN (
		SELECT
			pfp.project_ID,
			SUM(IFNULL(pfp.payCapitalSum, 0)) AS payCapitalSum
		FROM
			pro_factpay pfp
		WHERE 1 = 1 AND DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='2015-01' GROUP BY
			pfp.project_ID
	) tab1 ON tab1.project_ID = pp.project_ID
	LEFT JOIN (
		SELECT
			pre.project_ID,
			SUM(IFNULL(pre.replaceCapitalSum, 0)) AS replaceCapitalSum
		FROM
			pro_replace pre
		WHERE
			1 = 1 AND  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='2015-01' GROUP BY pre.project_ID
	) tab2 ON tab2.project_ID = pp.project_ID
	WHERE
		pp.`busiClass` = '02' 
		AND DATE_FORMAT(pp.reportDate,'%Y-%m') &lt;= '2015-01'
		GROUP BY pa.`clientGUID`
) wdAll15 ON wdAll15.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM((IFNULL(pp.loadSum,0)-IFNULL(tab1.payCapitalSum,0)-IFNULL(tab2.replaceCapitalSum,0))) AS guarantySum FROM pro_project pp
           LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
           LEFT JOIN (SELECT pfp.project_ID, SUM(IFNULL(pfp.payCapitalSum,0)) AS payCapitalSum FROM pro_factpay pfp 
                      WHERE 1=1 ${has(endyearmonthsql)?("  and  DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY pfp.project_ID
)tab1 ON tab1.project_ID =  pp.project_ID
LEFT JOIN ( SELECT pre.project_ID,SUM(IFNULL(pre.replaceCapitalSum,0)) AS replaceCapitalSum FROM pro_replace pre 
                      WHERE 1=1 ${has(endyearmonthsql)?("  and  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY pre.project_ID 
)tab2 ON tab2.project_ID =  pp.project_ID
WHERE  pp.`busiClass` = '01' 
${has(endyearmonthsql)?(" and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""}
${has(wheresql)?(" and wheresql='"+wheresql+"'"):""}   GROUP BY pa.`clientGUID`
) tt1 ON tt1.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM((IFNULL(pp.loadSum,0)-IFNULL(tab1.payCapitalSum,0))) AS entrustSum FROM pro_project pp
           LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
           LEFT JOIN (SELECT pfp.project_ID, SUM(IFNULL(pfp.payCapitalSum,0)) AS payCapitalSum FROM pro_factpay pfp 
                      WHERE 1=1 ${has(endyearmonthsql)?("  and  DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} GROUP BY pfp.project_ID
)tab1 ON tab1.project_ID =  pp.project_ID
WHERE  pp.`busiClass` = '02' 
${has(endyearmonthsql)?(" and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""}
${has(wheresql)?(" and wheresql='"+wheresql+"'"):""}  GROUP BY pa.`clientGUID`
) tt2 ON tt2.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM(pfp.`payCapitalSum`) payCapitalSum,SUM(pfp.`payInterestSum`) payInterestSum FROM pro_factpay pfp
           LEFT JOIN pro_project pp ON pp.`project_ID` = pfp.`project_ID`
           LEFT JOIN pro_apply pa ON pfp.`applyID` = pa.`apply_ID`
           WHERE pp.`busiClass` = '02' ${has(endyearmonthsql)?("  and  DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""} 
           ${has(endyearmonthsql)?(" and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m')&lt;='"+endyearmonthsql+"'"):""}
           ${has(wheresql)?(" and wheresql='"+wheresql+"'"):""}GROUP BY pa.`clientGUID`
) pay ON pay.clientGUID = cc.`clientGUID`
WHERE cr.projectTypeID = '44950f5de8614f1588841a9556ba52a2'
UNION ALL
SELECT cc.fullAreaName,
	cc.`relationMainName`,
	cc.`clientName`,IFNULL(tt1.guarantySum,0) timePointSum,
	IFNULL(tt2.entrustSum,0) timePointEntrustSum,
	IFNULL(db15.guarantySum, 0) timePointSum,
	IFNULL(wd15.`guarantySum`,0) timePointEntrustSum,
	IFNULL(wdAll15.`guarantySum`,0) wdAllGuarantySum,
	IFNULL(pay.payCapitalSum,0) payCapitalSum,
	IFNULL(pay.payInterestSum,0) payInterestSum
FROM crm_client cc 
LEFT JOIN crm_client_relationmain ccr ON ccr.`client_ID` = cc.client_ID
LEFT JOIN crm_relationmain cr ON cr.`relationMain_ID` = ccr.`relationMain_ID`
LEFT JOIN (
	SELECT
		pa.`clientGUID`,
		SUM((IFNULL(pp.loadSum, 0) - IFNULL(tab1.payCapitalSum, 0) - IFNULL(tab2.replaceCapitalSum, 0))) AS guarantySum
	FROM
		pro_project pp
	LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
	LEFT JOIN (
		SELECT
			pfp.project_ID,
			SUM(IFNULL(pfp.payCapitalSum, 0)) AS payCapitalSum
		FROM
			pro_factpay pfp
		WHERE 1 = 1 AND DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='2015-01' GROUP BY
			pfp.project_ID
	) tab1 ON tab1.project_ID = pp.project_ID
	LEFT JOIN (
		SELECT
			pre.project_ID,
			SUM(IFNULL(pre.replaceCapitalSum, 0)) AS replaceCapitalSum
		FROM
			pro_replace pre
		WHERE
			1 = 1 AND  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='2015-01' GROUP BY pre.project_ID
	) tab2 ON tab2.project_ID = pp.project_ID
	WHERE
		pp.`busiClass` = '01' 
		AND DATE_FORMAT(pp.reportDate,'%Y-%m')&lt;= '2015-01'
		GROUP BY pa.`clientGUID`
) db15 ON db15.clientGUID = cc.`clientGUID`

LEFT JOIN (
	SELECT
		pa.`clientGUID`,
		SUM((IFNULL(pp.loadSum, 0) - IFNULL(tab1.payCapitalSum, 0) - IFNULL(tab2.replaceCapitalSum, 0))) AS guarantySum
	FROM
		pro_project pp
	LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
	LEFT JOIN (
		SELECT
			pfp.project_ID,
			SUM(IFNULL(pfp.payCapitalSum, 0)) AS payCapitalSum
		FROM
			pro_factpay pfp
		WHERE 1 = 1 AND DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='2015-01' GROUP BY
			pfp.project_ID
	) tab1 ON tab1.project_ID = pp.project_ID
	LEFT JOIN (
		SELECT
			pre.project_ID,
			SUM(IFNULL(pre.replaceCapitalSum, 0)) AS replaceCapitalSum
		FROM
			pro_replace pre
		WHERE
			1 = 1 AND  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='2015-01' GROUP BY pre.project_ID
	) tab2 ON tab2.project_ID = pp.project_ID
	WHERE
		pp.`busiClass` = '02' 
		AND DATE_FORMAT(pp.reportDate,'%Y-%m') &lt;= '2015-01'
		AND pa.guarantyOrgID in ('1b6f710ce5054d1d8f9d495f7bc1e142','fbe555a29dd94ed08dacf374dcd85ead','d6f953c683ea41abb946a42fc1004642','73c1bb3d20614bdfa91281622c5b9334')
		GROUP BY pa.`clientGUID`
) wd15 ON wd15.clientGUID = cc.`clientGUID`

LEFT JOIN (
	SELECT
		pa.`clientGUID`,
		SUM((IFNULL(pp.loadSum, 0) - IFNULL(tab1.payCapitalSum, 0) - IFNULL(tab2.replaceCapitalSum, 0))) AS guarantySum
	FROM
		pro_project pp
	LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
	LEFT JOIN (
		SELECT
			pfp.project_ID,
			SUM(IFNULL(pfp.payCapitalSum, 0)) AS payCapitalSum
		FROM
			pro_factpay pfp
		WHERE 1 = 1 AND DATE_FORMAT(pfp.payDate,'%Y-%m')&lt;='2015-01' GROUP BY
			pfp.project_ID
	) tab1 ON tab1.project_ID = pp.project_ID
	LEFT JOIN (
		SELECT
			pre.project_ID,
			SUM(IFNULL(pre.replaceCapitalSum, 0)) AS replaceCapitalSum
		FROM
			pro_replace pre
		WHERE
			1 = 1 AND  DATE_FORMAT(pre.replaceDate,'%Y-%m')&lt;='2015-01' GROUP BY pre.project_ID
	) tab2 ON tab2.project_ID = pp.project_ID
	WHERE
		pp.`busiClass` = '02' 
		AND DATE_FORMAT(pp.reportDate,'%Y-%m') &lt;= '2015-01'
		GROUP BY pa.`clientGUID`
) wdAll15 ON wdAll15.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM((IFNULL(pp.loadSum,0)-IFNULL(tab1.payCapitalSum,0)-IFNULL(tab2.replaceCapitalSum,0))) AS guarantySum FROM pro_project pp
           LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
           LEFT JOIN (SELECT pfp.project_ID, SUM(IFNULL(pfp.payCapitalSum,0)) AS payCapitalSum FROM pro_factpay pfp 
                      WHERE 1=1   and  DATE_FORMAT(pfp.payDate,'%Y-%m') BETWEEN '2015-01-01' AND '2015-01-31' GROUP BY pfp.project_ID
)tab1 ON tab1.project_ID =  pp.project_ID
LEFT JOIN ( SELECT pre.project_ID,SUM(IFNULL(pre.replaceCapitalSum,0)) AS replaceCapitalSum FROM pro_replace pre 
                      WHERE 1=1   and  DATE_FORMAT(pre.replaceDate,'%Y-%m-%d') BETWEEN '2015-01-01' AND '2015-01-31' GROUP BY pre.project_ID 
)tab2 ON tab2.project_ID =  pp.project_ID
WHERE  pp.`busiClass` = '01' 
 and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m-%d') BETWEEN '2015-01-01' AND '2015-01-31'
   GROUP BY pa.`clientGUID`
) tt1 ON tt1.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM((IFNULL(pp.loadSum,0)-IFNULL(tab1.payCapitalSum,0))) AS entrustSum FROM pro_project pp
           LEFT JOIN pro_apply pa ON pp.`apply_ID` = pa.`apply_ID`
           LEFT JOIN (SELECT pfp.project_ID, SUM(IFNULL(pfp.payCapitalSum,0)) AS payCapitalSum FROM pro_factpay pfp 
                      WHERE 1=1   and  DATE_FORMAT(pfp.payDate,'%Y-%m-%d') BETWEEN '2015-01-01' AND '2015-01-31' GROUP BY pfp.project_ID
)tab1 ON tab1.project_ID =  pp.project_ID
WHERE  pp.`busiClass` = '02' 
 and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m-%d') BETWEEN '2015-01-01' AND '2015-01-31'
  GROUP BY pa.`clientGUID`
) tt2 ON tt2.clientGUID = cc.`clientGUID`
LEFT JOIN (SELECT pa.`clientGUID`,SUM(pfp.`payCapitalSum`) payCapitalSum,SUM(pfp.`payInterestSum`) payInterestSum FROM pro_factpay pfp
           LEFT JOIN pro_project pp ON pp.`project_ID` = pfp.`project_ID`
           LEFT JOIN pro_apply pa ON pfp.`applyID` = pa.`apply_ID`
           WHERE pp.`busiClass` = '02'   and  DATE_FORMAT(pfp.payDate,'%Y-%m-%d') BETWEEN '2015-01-01' AND '2015-01-31'
            and  DATE_FORMAT(pp.`delayBeginDate`,'%Y-%m-%d') BETWEEN '2015-01-01' AND '2015-01-31'
           GROUP BY pa.`clientGUID`
) pay ON pay.clientGUID = cc.`clientGUID`
WHERE cr.projectTypeID = '44950f5de8614f1588841a9556ba52a2' 
) A
GROUP BY A.`clientName`</Description><Connection><Driver>${property("proxool.driverClassName")}</Driver><User>${property("proxool.username")}</User><Password>${property("proxool.password")}</Password><Url>${property("proxool.url")}</Url></Connection></Reader><IndexFields Len="1">fullAreaName</IndexFields><TagName>tab_detail</TagName></Item0><Item1><Children ItemClass="IndexNodeSource"><Item0><IndexFields Len="1">id</IndexFields><TagName>index_fullAreaID</TagName></Item0></Children><Reader Class="SqlReader"><Name>dic_fullAreaName</Name><Sql>SELECT DISTINCT cc.`fullAreaName` id, cc.`fullAreaName`  FROM crm_client cc 
LEFT JOIN crm_client_relationmain ccr ON ccr.`client_ID` = cc.client_ID
LEFT JOIN crm_relationmain cr ON cr.`relationMain_ID` = ccr.`relationMain_ID`
WHERE cr.projectTypeID = '44950f5de8614f1588841a9556ba52a2' </Sql><Description>SELECT DISTINCT cc.`fullAreaName` id, cc.`fullAreaName`  FROM crm_client cc 
LEFT JOIN crm_client_relationmain ccr ON ccr.`client_ID` = cc.client_ID
LEFT JOIN crm_relationmain cr ON cr.`relationMain_ID` = ccr.`relationMain_ID`
WHERE cr.projectTypeID = '44950f5de8614f1588841a9556ba52a2' </Description><Connection><Driver>${property("proxool.driverClassName")}</Driver><User>${property("proxool.username")}</User><Password>${property("proxool.password")}</Password><Url>${property("proxool.url")}</Url></Connection></Reader><IndexFields Len="1">id</IndexFields><TagName>dic_fullAreaName</TagName></Item1></Children></NodeSource><Properties/></jatools>